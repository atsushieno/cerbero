# -*- Mode: Python -*- vi:si:et:sw=4:sts=4:ts=4:syntax=python

class Recipe(recipe.Recipe):
    name = 'zita-resampler'
    version = '1.6.2'
    licenses = [{License.GPLv3Plus: ['COPYING']}]
    btype = BuildType.CUSTOM
    stype = SourceType.TARBALL
    url = 'https://github.com/atsushieno/android-native-audio-builders/releases/download/r2/zita-resampler-1.6.2.tar.bz2'
    tarball_checksum = '233baefee297094514bfc9063e47f848e8138dc7c959d9cd957b36019b98c5d7'
    deps = ['fftw3']
    patches = ['zita-resampler/zita-resampler-arch.patch']

    def install(self):
        shell.call ('cd ' + self.build_dir + '/source && CXX="' + self.get_env('CXX') + ' ' + self.get_env('CXXFLAGS') + ' -lstdc++" LDFLAGS="' + self.get_env('LDFLAGS') + '" make')
        shell.call ('cp -R ' + self.build_dir + '/source/zita-resampler ' + self.config.prefix + '/include')
        shell.call ('cp ' + self.build_dir + '/source/libzita-resampler.so.' + self.version + ' ' + self.config.prefix + '/lib/libzita-resampler.so')

    def clean(self):
        shell.call ('cd ' + self.build_dir + '/source && make clean')

